{
  "version": "2.0.0",
  "tags": {
    "master": {
      "description": "Main development tasks for Vibe Survivors",
      "metadata": {
        "created": "2024-12-19T00:00:00.000Z",
        "lastModified": "2024-12-19T16:45:00.000Z"
      },
      "tasks": [
        {
          "id": "1",
          "title": "Create CurseVictoryScene",
          "description": "Create a new Phaser scene that appears after player victory to show curse acquisition",
          "status": "done",
          "priority": "high",
          "dependencies": [],
          "details": "Create a new scene class called CurseVictoryScene in the scenes directory. The scene should:\n- Use curse_bg asset as the background\n- Initialize with proper scene management\n- Set up containers for UI elements\n- Handle scene transitions properly\n- Follow the existing scene patterns used in the game\n\nIMPLEMENTATION NOTES:\n- ✅ Created CurseVictoryScene.ts following VictoryScene and DeadScene patterns\n- ✅ Proper imports: Phaser, SpacetimeDBClient, GameEvents, MusicManager\n- ✅ Constructor sets up spacetimeDBClient and gameEvents references\n- ✅ Preload method loads curse_bg and curse_card assets\n- ✅ Create method implements curse_bg background display\n- ✅ Responsive design with proper handleResize method\n- ✅ Corner shading for visual depth\n- ✅ Container setup for future UI elements\n- ✅ Proper cleanup in shutdown method\n- ✅ Console logging for debugging\n- ✅ Class icon preloading for smooth transitions",
          "testStrategy": "Test by triggering victory condition and verifying the scene appears with curse_bg background"
        },
        {
          "id": "2", 
          "title": "Implement curse_incant sound on scene entry",
          "description": "Play the curse_incant sound effect when CurseVictoryScene starts",
          "status": "done",
          "priority": "medium",
          "dependencies": ["1"],
          "details": "Add sound playback functionality to CurseVictoryScene:\n- Use the existing SoundManager to play 'curse_incant' sound\n- Trigger sound in the scene's create() method\n- Ensure sound volume respects user settings\n- Handle cases where sound assets might not be loaded\n\nIMPLEMENTATION NOTES:\n- ✅ Added curse_incant sound playback in create() method\n- ✅ Sound plays at full volume (1.0) following scene pattern\n- ✅ Uses global soundManager via (window as any).soundManager\n- ✅ Added try-catch error handling for sound playback\n- ✅ Added console logging for debugging\n- ✅ Added warning if SoundManager not available\n- ✅ Sound asset confirmed to exist: curse_incant.mp3 in assets/sounds\n- ✅ Follows same pattern as VictoryScene and DeadScene\n- ✅ FIXED: Added sound loading in preload() method\n- ✅ Added curse_incant and curse_created audio loading\n- ✅ Build tested successfully, no compilation errors",
          "testStrategy": "Enter CurseVictoryScene and verify curse_incant sound plays immediately"
        },
        {
          "id": "3",
          "title": "Add curse_card sprite with fade-in animation", 
          "description": "Display curse_card sprite at bottom of screen with fade-in effect",
          "status": "done",
          "priority": "medium", 
          "dependencies": ["1"],
          "details": "Implement curse card appearance:\n- Position curse_card sprite at bottom center of screen\n- Start with alpha=0 (invisible)\n- Create fade-in tween animation\n- Time the fade-in to occur after curse_incant sound\n- Use responsive positioning for different screen sizes\n\nIMPLEMENTATION NOTES:\n- ✅ Added curseCard property to class for proper management\n- ✅ Created createCurseCard() method for setup\n- ✅ Card positioned at height * 0.4 (bottom area) relative to container center\n- ✅ Card starts with alpha=0 (invisible) and depth=10 (on top)\n- ✅ Added to curseContainer for proper organization\n- ✅ Timed delay of 800ms after sound starts before fade-in begins\n- ✅ Implemented fadeInCurseCard() with smooth 1-second fade-in\n- ✅ Used this.tweens.add() following existing scene patterns\n- ✅ Added responsive positioning update in handleResize()\n- ✅ Added proper cleanup in shutdown() method\n- ✅ Console logging for debugging throughout\n- ✅ Build tested successfully, no compilation errors",
          "testStrategy": "Verify curse_card appears at bottom and fades in smoothly after sound"
        },
        {
          "id": "4",
          "title": "Implement card fly-to-UI animation with curse_created sound",
          "description": "Animate curse_card flying to top-right position with sound effect",
          "status": "done", 
          "priority": "high",
          "dependencies": ["3"],
          "details": "✅ COMPLETED: Created card flight animation:\n- ✅ Calculated target position matching curse UI location (width-80, 80)\n- ✅ Created smooth tween animation using Power2 easing\n- ✅ Plays 'curse_created' sound when animation starts (1.0 volume)\n- ✅ Card scales to 0.3 during flight to match CurseUI scale\n- ✅ Animation duration is 1.5 seconds for satisfying feel\n- ✅ Added isCardFlying state tracking to prevent resize interference\n- ✅ Chains from fade-in completion using onComplete callback\n- ✅ Triggers 1-second delay before scene transition\n- ✅ Proper container-relative coordinate conversion\n- ✅ Console logging for debugging throughout\n- ✅ Build tested successfully, no compilation errors",
          "testStrategy": "✅ VERIFIED: Card flies smoothly to top-right and curse_created sound plays at start of animation"
        },
        {
          "id": "5",
          "title": "Integrate with curse UI system", 
          "description": "Show curse UI or increment counter when card reaches destination",
          "status": "done",
          "priority": "high", 
          "dependencies": ["4"],
          "details": "✅ COMPLETED: Curse system integration with Roman numeral counting:\n\n**Corrected Animation Flow:**\n- Card animation (bottom-to-top-right) ALWAYS happens regardless of curse count\n- The difference is what happens when the card reaches the destination:\n  * First curse (count=0): Shows curse system appearing for the first time\n  * Existing curses (count>0): Shows current count, then increments to new count\n\n**Smart Destination Behavior:**\n- handleCardReachedDestination(): Determines behavior based on initial curse count\n- First curse: Creates Roman numeral \"I\" (curse system now visible)\n- Existing curses: Creates current count first, then schedules increment after brief pause\n- Proper visual progression that matches user expectations\n\n**Roman Numeral Integration:**\n- Uses same ROMAN_NUMERALS array as CurseUI (I, II, III... up to XX)\n- Creates curseCountText with identical styling to CurseUI\n- Positioned at exact same coordinates as curse UI (width-80, 80)\n- Text appears above card with proper depth and styling\n\n**Dynamic Count Display for Existing Curses:**\n- Shows previous count initially (e.g., \"II\" if there are 3 total curses)\n- Brief 300ms pause to let user see current state\n- Then increments to actual count (e.g., \"III\") with smooth scaling animation\n- Text scaling effect during count change for visual emphasis\n\n**Visual Feedback System:**\n- Pulsing scale animation (0.3 to 0.35 scale, 3 pulses)\n- Orange tint effect (0xffaa00) for visual confirmation\n- incrementCurseCountDisplay(): Handles Roman numeral increment with animation\n- Coordinated timing for smooth user experience\n\n**Architecture Understanding:**\n- Curse added by backend BEFORE scene starts (on boss defeat)\n- Scene shows visual representation of what already happened\n- Animation always provides satisfying visual flow\n- Behavior adapts based on existing curse state\n\n**Implementation Details:**\n- checkCurrentCurseCount(): Reads curse database on scene start\n- createCardAtBottom(): Always handles bottom-to-top animation\n- handleCardReachedDestination(): Routes to appropriate behavior\n- createCurseCountText(): Roman numeral text creation\n- Proper cleanup of count text in shutdown method\n- Removed unused createCardAtTopRight() method\n\nBUILD STATUS: ✅ Compiles successfully",
          "testStrategy": "✅ READY FOR TESTING: Verify curse UI appears on first victory, counter increments on subsequent victories, visual feedback animations work properly"
        },
        {
          "id": "6",
          "title": "Add transition delay and return to character select",
          "description": "Wait briefly then transition back to character select menu",
          "status": "pending",
          "priority": "medium",
          "dependencies": ["5"], 
          "details": "Implement scene exit:\n- Add appropriate delay after curse UI update (2-3 seconds)\n- Transition smoothly back to character select scene\n- Ensure all tweens/animations are cleaned up\n- Reset any temporary state\n- Follow existing scene transition patterns",
          "testStrategy": "Verify scene waits appropriate time then smoothly returns to character select"
        },
        {
          "id": "7",
          "title": "Wire CurseVictoryScene into victory flow",
          "description": "Integrate the new scene into the existing victory condition handling",
          "status": "pending",
          "priority": "high",
          "dependencies": ["6"],
          "details": "Connect to existing victory system:\n- Modify victory handling code to go to CurseVictoryScene instead of direct VictoryScene\n- Ensure scene is properly added to the game's scene list\n- Handle proper scene order: GameScene -> CurseVictoryScene -> CharacterSelectScene\n- Test with different victory conditions (boss defeat, etc.)\n- Ensure multiplayer victory scenarios work correctly",
          "testStrategy": "Achieve victory in game and verify CurseVictoryScene appears before character select"
        }
      ]
    }
  },
  "currentTag": "master",
  "metadata": {
    "created": "2024-12-19T00:00:00.000Z",
    "lastModified": "2024-12-19T16:45:00.000Z"
  }
} 